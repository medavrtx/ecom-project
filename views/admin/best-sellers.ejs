<% layout('layouts/boilerplate')%>

<div class="container-fluid">
  <div class="row">
    <!-- Sidebar Navigation -->
    <div class="col-lg-2 bg-light border-end sidebar py-4">
      <ul class="nav flex-column pt-4">
        <li class="nav-item">
          <a class="nav-link link" href="/admin/edit-products">Edit Products</a>
        </li>
        <li class="nav-item">
          <a class="nav-link link" href="/admin/categories">Categories</a>
        </li>
        <li class="nav-item">
          <a class="nav-link link active" href="/admin/best-sellers">
            Best Sellers
          </a>
        </li>
      </ul>
    </div>

    <div class="col-lg-10 content">
      <div class="my-5">
        <h1 class="center-title"><%= pageTitle %></h1>
      </div>

      <!-- Available Products Section -->
      <div class="container-lg">
        <div class="row mx-5">
          <div class="col-12">
            <% if (products) { %>
            <div class="row align-items-start">
              <% for (let product of products) { %>
              <article class="col-lg-4 mb-4">
                <div class="card">
                  <a href="/admin/best-sellers/add/<%= product._id %>">
                    <div class="product-img">
                      <img
                        class="img-fluid d-block mx-auto img-hover"
                        src="/<%= product.image %>"
                        alt="<%= product.title %>"
                      />
                    </div>
                  </a>
                  <p
                    href="#"
                    class="d-block text-dark text-decoration-none py-2 my-0 product-name"
                  >
                    <%= product.title %>
                  </p>
                  <span class="product-price">$<%= product.price %></span>
                  <div class="btn-row my-2">
                    <a href="/admin/best-sellers/add/<%= product._id %>">
                      <button type="button" class="btn btn-outline-dark">
                        Add to Best Sellers
                      </button>
                    </a>
                  </div>
                </div>
              </article>
              <% } %>
            </div>
            <% } else { %>
            <p>No available products found.</p>
            <% } %>
          </div>
        </div>
      </div>

      <!-- Best Sellers List Section -->
      <div class="container-lg mt-4">
        <div class="row mx-5">
          <div class="col-lg-12">
            <h2>Best Sellers List</h2>
            <% if (bestSellers && bestSellers.length > 0) { %>
            <ol id="sortable-list" class="list-group">
              <% for (let i = 0; i < bestSellers.length; i++) { %>
              <li class="list-group-item" data-id="<%= bestSellers[i]._id %>">
                <%= bestSellers[i].title %> - $<%= bestSellers[i].price %>
                <div class="btn-group" role="group">
                  <a href="/admin/best-sellers/edit/<%= bestSellers[i]._id %>">
                    <button type="button" class="btn btn-outline-primary">
                      Edit
                    </button>
                  </a>
                  <button
                    type="button"
                    class="btn btn-outline-danger"
                    onclick="removeBestSeller('<%= bestSellers[i]._id %>')"
                  >
                    Remove
                  </button>
                </div>
              </li>
              <% } %>
            </ol>
            <% } else { %>
            <p>No products in the Best Sellers list.</p>
            <% } %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
